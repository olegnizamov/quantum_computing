# Мультикубитные системы


4.1. MITM - вмешательство в работу протокола BB-84 и последствия

Попытка вмешательства в протокол BB-84 с помощью свойства запутанности

Допустим, Алиса, выбрав базис для кодирования, отправила Бобу информацию, но Еве удалось перехватить данные. Ева самостоятельно запутывает кубит с помощью вентиля CNOT, при этом отсылая перехваченное значение Бобу. Теперь ей необходимо дождаться, когда Алиса и Боб огласят базис для дешифрования, и измерить значение собственного кубита. К сожалению для Евы, это может сработать только в базисе {|0⟩;|1⟩}.

Возможная проблема

Теперь рассмотрим случай, когда Алиса выбрала {|+⟩;|-⟩} базис. Ева, подключая вентиль CNOT, получает пару Белла, также отправляя Бобу данные от Алисы. Он выбирает базис для декодирования: {|0⟩;|1⟩} не подходит, для измерения в этом примере необходимо использовать базис {|+⟩;|-⟩}. Бобу также понадобится ввести вентиль Адамара перед измерением. Теперь в половине случаев он получит 1, что не соответствуют отправленным данным. Поэтому Алиса и Боб легко поймут, сверяя коды, что кто-то пытался вмешаться в их разговор.

4.2. Мультикубитные системы: измерение множества и одного кубита из него

Часть 8. Мультикубитные системы

Мультикубитные системы состоят из n кубитов, каждый из которых может быть |0⟩ или |1⟩, таким образом, 2^n возможных значений. Вероятность не может быть больше 1(n - целое число)). Общее значение системы будет равно сумме произведений комплексных значений вероятности и базовых значений кубитов.

![](https://thumb.tildacdn.com/tild3433-6561-4466-a464-396633343766/-/resize/560x/-/format/webp/image001.png)

Измерение многокубитных систем

Результатом измерения многокубитной системы будет одно из её базовых состояний. Вероятность равенства системы какому-то из значений есть квадрат амплитуды полученного состояния.

Измерение одного кубита из системы

Возможно также и измерение отдельных кубитов системы. Вероятность равенства одного кубита системы 0 или 1 равна сумме квадратов амплитуд тех кубитов, j-ый бит которых равен 0 или 1.

![](https://thumb.tildacdn.com/tild6630-3633-4662-a665-663038646539/-/resize/560x/-/format/webp/image003.png)

4.3. Многокубитные вентили: универсальные, вентиль Тоффоли и их схема

Многокубитные вентили

Многокубитная система может быть также представлена как вектор-столбец амплитудных значений вероятности. А многокубитные вентили, в свою очередь, являются квадратными матрицами, размера 2nx2n.

![](https://static.tildacdn.com/tild3839-3433-4439-b832-636262363365/-/empty/image005.png)

Вентиль Тоффоли

Это трёхкубитный вентиль, который также называют вентилем двойного контроля и отрицания (CCNOT). В случае, если два кубита равны, значение третьего меняется на противоположное. Вентиль Тоффоли является универсальным для классической логики. Однако его повсеместное использование для квантовых схем излишне, так как данный вентиль может быть представлен одно- или двухкубитными вентилями.

![](https://static.tildacdn.com/tild6237-3637-4737-a439-623161663233/-/empty/image007.png)

Универсальные вентили

Универсальными в квантовом вычислении являются однокубитные вентили (можно даже сказать только X-, H- и T-вентили) и вентиль CNOT. Это значит, что используя только их, можно воссоздать тождественные действия любых других вентилей.

Создание равнозначных комбинаций вентилей

Так, для примера, действия вентиля Z могут выполнены введением следующей группы: H-X-H. Представление вентилей может быть полезно, например, при изучении отказоустойчивого вычисления, однако в программы вроде IBM Quantum Experience уже включён большой ряд разработанных вентилей.

![](https://static.tildacdn.com/tild6531-3830-4337-b335-626631303037/-/empty/image009.png)

Эквивалентная схема вентиля Тоффоли

Для более сложных вентилей часто удаётся создать точное разложение. Вентиль Тоффоли можно представить комбинацией четырёх вариантов вентилей: Адамара, Т и ему противоположного, контролируемого отрицания. В этом варианте первый кубит является объектом (кубит, который меняет своё значение), два остальных управляющие (проверяется их равенство).

![](https://static.tildacdn.com/tild3930-6662-4963-a366-333265653261/-/empty/image011.png)

4.4. Квантовый параллелизм: вычисление через алгоритм Дойча, со стороны суперпозиции, и польза интерференции

Часть 9. Квантовый параллелизм

Многие считают, что одним из основных свойств квантовых компьютеров является одновременное параллельное выполнение большого числа задач. Это отчасти правда, далее узнаем подробнее.

Использование функции в алгоритме Дойча

В квантовом вычислении каждый вентиль обратим. Поэтому и используемые функции дополняются информацией, чтобы стать реверсивными. Например, в алгоритме Дойча, существует оракул, после прохождения которого входные данные остаются неизменными, а для записи решений используется специальный кубит.

![](https://thumb.tildacdn.com/tild6462-3630-4161-b434-613537376139/-/resize/506x/-/format/webp/image013.png)

Вычисление функции со стороны суперпозиции

Рассмотрим логическую функцию с одним входом. Используя вентиль Адамара, мы приводим кубит к суперпозиции значений 0 и 1; теперь по свойству линейности кубит можно представить как сумму отдельных значений. Далее оракул влияет на каждую из частей, и выходит, что один раз вызвав функцию, будут получены два её значения.

Влияние тензорного произведения

То же работает и для многокубитных систем. Теперь у логической функции n входов. К каждому из них подключаются H-вентили, чтобы иметь все возможные входные значения в суперпозиции. Подключая оракул ко всем кубитам одновременно, будут вычислены все значения функции лишь одним её вызовом.

Квантовый параллелизм против недетерминированных машин

В недетерминированных машинах¹ вычислительный процесс разделяется на части так, что каждая из них выполняется одновременно с другими. Если один из результатов функции будет равен ожидаемому, вычисление считается успешным. Это математическая модель, которая пока не имеет применения на практике. Предполагается, что решение задачи её воплощения поможет решить задачи NP класса.

¹ Недетерминированные машины имеют конечное число возможных шагов, из которых в очередной момент выбирается какой-то один.

Не всё то золото

Получается, в недетерминированных машинах мы сами выбираем подходящий ответ. Но для действительного получения результата в квантовом вычислении, необходимо провести измерение. Это может закончиться провалом, так как выходные значения будут выбираться случайным образом.

Интерференция приходит на помощь

Единственный верный, хоть и сложный вариант, использование свойства интерференции². Так можно будет убрать амплитуды неподходящих значений, что повысит вероятность получения задуманного ответа.

² Квантовой интерференцией называют положение квантовой теории, которое гласит, что частица вроде фотона при движении может пересекать собственную траекторию.

4.5. Алгоритм Дойча-Йожи: схема, шаги, определение точности и моделирование в IBM QE

Часть 10. Алгоритм Дойча-Йожи

Вспомним алгоритм Дойча

Это задача, в которой необходимо выяснить, является ли логическая функция с одним входом постоянной или пропорциональной. В классическом варианте решения для этого понадобится как минимум два вызова оракула функции; её решение на квантовом компьютере возможно одним вызовом.

Усложняем: алгоритм Дойча-Йожи

Расширим задачу: пусть у логической функции существует n входов, то есть n переменных; необходимо определить вид функции за как можно меньшее число её вызовов. Здесь задействуются логические функции с ограниченным числом входов, так как логические n-функции могут не быть ни постоянными, ни пропорциональными. Для классического решения понадобится 2n-1+1 вызовов функции; используя квантовый алгоритм Дойча-Йожи вычислить функцию будет необходимо лишь раз.

Схема

Это обобщённая версия алгоритма Дойча, поэтому в схеме увеличено число входов. Значение вспомогательного кубита - |1⟩.

![](https://thumb.tildacdn.com/tild6665-3139-4831-b961-653834323565/-/resize/560x/-/format/webp/image015.png)

Шаги алгоритма

Начальное состояние функции - |0...0⟩. После ввода вентилей Адамара достигается суперпозиция значений. Оракул, будучи линейной функцией, действует на каждую из частей получившегося произведения по отдельности. Далее к основным кубитам подключается второй ряд вентилей Адамара и проводится их измерение. Получив |0⟩, подтверждаем, что функция постоянна; если результат отличен от нуля, функция является пропорциональной.

![](https://static.tildacdn.com/tild6562-3934-4065-b766-613031653163/-/empty/image017.png)

![](https://static.tildacdn.com/tild6338-3863-4335-b035-356334656363/-/empty/image019.png)

Корректность алгоритма

Вероятность получения |0⟩ после измерений зависит от значения функции f(x). Если функция постоянна, ноль достигается каждый раз (вероятность равна 100%). Для пропорциональной функции эта вероятность равна нулю.

![](https://static.tildacdn.com/tild6533-3465-4635-b935-356535373135/-/empty/image021.png)

Схема

В эту квантовую схему как раз и включён "оракул", а также вентили Адамара. Если результат измерения равен 0, функция является постоянной, если же 1, её можно назвать пропорциональной.

![](https://static.tildacdn.com/tild3836-6337-4165-a662-323237363336/-/empty/image039.png)

Комментарии к алгоритму

Данная задача искусственно создана, чтобы показать потенциал квантового вычисления. Здесь, используя свойства квантового параллелизма и интерференции, можно рассчитать значение функции одним вычислением. Алгоритм Дойча-Йожи, как и его последователи, также может быть полезным в вопросе выяснения природы высокой скорости работы квантовых компьютеров.

Моделирование в IBM Quantum Experience

(Создание схемы по частям, задание двух оракулов для каждого варианта функции, запуск схемы для постоянной функции на симуляторе - получение нуля во всех случаях, запуск схемы для пропорциональной функции на симуляторе - получена строка, состоящая не только из единиц, во всех случаях, запуск на квантовом компьютере - получение разных значений из-за ошибок и помех компьютера, для постоянной функции наиболее частое значение 0000, для пропорциональной 0001.)

![](https://static.tildacdn.com/tild6532-3161-4433-b931-393735633766/-/empty/image023.jpg)

![](https://static.tildacdn.com/tild6463-3830-4864-b265-363239373365/-/empty/image025.jpg)

![](https://static.tildacdn.com/tild6438-3932-4535-a434-333635643438/-/empty/image027.jpg)

4.6. Алгоритм Гровера ч.1: как работает, поведение в квантовом поле

Часть 11. Алгоритм Гровера

Алгоритм Гровера решает задачу поиска элемента по критериям из несортированного списка. Решая задачу классическим методом, в среднем придётся перебрать половину значений, так как список не рассортирован. Квантовый алгоритм Гровера позволяет сократить это число до значения, равного квадратному корню числа элементов списка. Такой алгоритм удобно использовать для большого количества значений, часто его применяют, например, в ядерной физике для анализа больших баз данных.

Как это работает?

Для приёма информации из списка используется оракул (логическая функция). На вход подаются элементы и их номера, указывающие на место в списке. Если элемент удовлетворяет условию, функция оракула возвращает 1, в противном случае функция получает 0.

![](https://static.tildacdn.com/tild6462-6239-4530-b039-363033383132/-/empty/image029.png)

Идея алгоритма

Алгоритм основан на инверсии амплитуд относительно их среднего значения. Для начала примем равенство всех амплитуд. Если элемент удовлетворяет условию поиска, его амплитуда изменяет фазу, становясь отрицательной по отношению к остальным. Далее вычисляется среднее значение всех амплитуд для того, чтобы отразить их относительно этой величины. Так повторяется несколько раз пока все элементы, не равные 1, постепенно не сократят амплитуды, а искомый будет иметь её высокое значение.

![](https://static.tildacdn.com/tild3463-3161-4231-b062-313631323464/-/empty/image031.png)

Алгоритм Гровера в квантовом поле

Начало схемы аналогично алгоритму Дойча-Йожи. В оракуле необходимые значения "отмечаются" переворачиванием амплитуд. Далее идёт часть схемы, именуемая оператором рассеивания, где происходит вычисление и инверсия амплитуд.

![](https://static.tildacdn.com/tild6463-6130-4261-a162-383866353066/-/empty/image033.png)

Алгоритм Гровера = вращение

С геометрической точки зрения данный алгоритм рассматривается как объединение отражений, то есть вращение. Это доказывается и алгебраически. Можно рассчитать угол поворота, а также количество повторений действий для оракула. Начальное состояние записывается в виде суммы искомого и остальных значений. Так как коэффициенты этих величин находятся в диапазоне от 0 до 1, их можно представить в виде cos и sin произвольного угла θ, такого, что θ∈(0, π/2). После действий оракула и оператора рассеивания, значение функции оборачивается на 2θ; если повторить их m раз, этот угол становится равен (2m+1)θ. Принимая во внимание то, что sin(2m+1)θ должен быть равен 1, для получения искомого значения, приравниваем его к π/2. Так выясняем, что m - по сути, число запусков оракула - равно (π/4)*sqrt(N).

![](https://static.tildacdn.com/tild6339-3236-4230-b265-626636396638/-/empty/image035.png)

![](https://thumb.tildacdn.com/tild6630-3462-4463-b639-613263353239/-/resize/560x/-/format/webp/image037.png)

![](https://thumb.tildacdn.com/tild3331-6532-4239-b464-663366373462/-/resize/560x/-/format/webp/image039.png)

4.7. Алгоритм Гровера ч.2: поиск элементов и запуск в IBM QE

Поиск нескольких элементов

Если необходимо отыскать k элементов, где k>1, число итераций оракула и оператора рассеивания можно будет рассчитать по формуле m=(π/4)*sqrt(N/k).

![](https://thumb.tildacdn.com/tild3235-3665-4437-a535-393034393938/-/resize/560x/-/format/webp/image041.png)

Число элементов неизвестно

В случае, если количество искомых элементов неизвестно, применяется версия алгоритма Гровера с квантовым преобразованием Фурье. Это поможет оценить число элементов. Также рассматривается вариант, когда число итераций m не рассчитывается, а выбирается случайным образом. По итогу, любой из описанных способов поможет отыскать необходимый элемент sqrt(N) запросами функции.

Комментарии к алгоритму

Необходимо помнить, что работа данного алгоритма зависит от числа итераций и разрыва между самими значениями списка. Так, например, если число искомых элементов равно k=N/4, они будут найдены за один вызов функции. Но проведение слишком большого количества итераций снижает вероятность нахождения искомого значения. Несмотря на это, алгоритм имеет широкий спектр модификаций, например, для измерений минимума и максимума функций, и в целом считается наиболее быстрым квантовым поисковым методом из существующих.

Запуск алгоритма Гровера в IBM Quantum Experience

(Создание схемы по частям, создание функции только с одним элементом, удовлетворяющим условиям, объединение схемы, значение найдено одним запуском, увеличение числа итераций, зависимость числа итераций от вероятности.)

![](https://thumb.tildacdn.com/tild6138-6666-4464-b436-666235373435/-/resize/560x/-/format/webp/image043.jpg)
