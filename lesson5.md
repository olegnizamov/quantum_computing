# Квантовые алгоритмы комбинаторной оптимизации


5.1. Запускаем алгоритмы в IBM Quantum Experience

Запуск изученных алгоритмов в IBM Quantum Experience

(Использование модуля AQUA, который содержит некоторые распространенные схемы и алгоритмы; создание схемы для алгоритма Дойча-Йожи, задание исходных параметров, проверка функции; алгоритм Гровера: задание оракула, числа итераций, получение результата; описание оракула логическими выражениями; ход алгоритма, когда неизвестно число итераций или число необходимых решений, называется режим возрастания - запуск функции происходит пока результат не найден.)

5.2. Разбираемся в алгоритме Шора

Часть 12. Алгоритм Шора

Это наиболее эффективный способ разложения целых чисел на множители, одного из методов современного шифрования. Классические компьютеры могут решить подобную задачу, однако сложность алгоритма при этом растёт экспоненциально числу элементов. Использование квантовых компьютеров повышает скорость решения до количества элементов в квадрате.

Шаги алгоритма

Этот алгоритм относят к гибридным, так как часть его вычисляется на классическом компьютере, часть - на квантовом; в данном случае квантовое устройство понадобится для выполнения только одного пункта. Для начала проводится проверка исходного числа N. Если оно простое или является степенью простого числа, то алгоритм останавливается; в противном случае выбирается случайное число a больше 1 и меньше N и вычисляется НОД¹ a и N. Алгоритм завершается при НОДе большем 1. Если это не так, следующее действие выполняется на квантовом компьютере. Здесь необходимо вычислить r, период числа a по модулю N, такой, что ar ≡ 1 mod N. В случае, когда r нечётное, необходимо заново выбрать число a и проделать следующие после этого шаги. Когда r стало чётным, вычисляются две величины: x = ar/2+1 mod N; y = ar/2-1 mod N. При x = 0 необходимо выбрать другой вариант числа a; при y = 0 принимаем r = r/2 и проверяем новое значение r на чётность. Наконец вычисляются p = НОД(x, N) и q = НОД(y, N), во всяком случае одно из получившихся значений будет нетривиальным делителем числа N.

¹ Наибольший общий делитель

Корректность алгоритма

Произведение x и y кратно N, однако сами числа делителями для N не являются. Поэтому получившиеся результаты вычисления НОДов p и q могут стать множителями, составляющими число N. Пройдя все шаги алгоритма несколько раз, можно найти все возможные делители желаемого числа.

Моделирование алгоритма

Большая часть алгоритма Шора выполняется с использованием классических методов вычисления, однако расчёт одного из пунктов проводится на квантовом устройстве. Данный шаг описывает квантовая схема, включающая вентили Адамара для создания суперпозиции на основных кубитах, расчёт ax mod N и квантовое преобразование Фурье.

![](https://thumb.tildacdn.com/tild3561-6362-4461-b731-323038386337/-/resize/560x/-/format/webp/image001.png)

5.3. Измерение последовательности и преобразование Фурье

Первая часть: подготовка периодической последовательности

На этом шаге происходит расчёт суммы всех возможных значений x и суммы ax mod N по методу умножения, часто называемому “русским”, где показатель степени разбивается на двоичные выражения, и затем возведение проводится по частям. После измерения нижнего кубита схемы будет вычислено значение периода последовательности r.

![](https://thumb.tildacdn.com/tild6232-3432-4638-b739-396431313634/-/resize/460x/-/format/webp/image003.png)

Вторая часть: измерение периода

Далее используется квантовое преобразование Фурье (КПФ), которое обладает важными свойствами для нахождения периода. Одно из них, независимость от сдвига, позволяет рассматривать любую из получившихся последовательностей с одинаковой вероятностью получения результата. Второе из них говорит о преобразовании периода r в период M/r, где M = 2m.

![](https://thumb.tildacdn.com/tild3266-3034-4362-b638-323562333964/-/resize/460x/-/format/webp/image005.png)

Квантовое преобразование Фурье

КПФ похоже на классическую дискретную версию преобразования Фурье. Оно описывается схемой с вентилями Адамара и вращения вокруг оси Z и операциями обмена между кубитами. Использование КПФ позволяет сократить число используемых вентилей до значения, равного квадрату количества кубитов в схеме, тогда как в классическом варианте это значение растёт экспоненциально величине схемы.

![](https://thumb.tildacdn.com/tild6532-3566-4438-b063-363965633163/-/resize/460x/-/format/webp/image007.png)

Использование КПФ для оценки фаз

В методе Шора КПФ рассматривается как частный случай квантового алгоритма определения фазы. Здесь используется схема, где из заданных величин - унитарной операции, являющейся матрицей, и одного из её собственных значений e2πiθ, - вычисляется значение угла θ, θ∈[0;1). Далее включается обратное КПФ и проводится измерение фазы; будет получено значение приблизительно равное 2nθ.

![](https://thumb.tildacdn.com/tild6631-3535-4466-a333-373965313031/-/resize/560x/-/format/webp/image009.png)

Алгоритм Шора для оценки фазы

Можно заметить, что схема, используемая для алгоритма Шора, подходит и для квантовой оценки фазы. Так, через собственные значения матриц U, которые отвечают за возведение в степень, вычисляется период r. Подготовка собственных векторов может вызвать некоторые трудности, поэтому используется факт того, что начальное значение алгоритма является суперпозицией всех возможных векторов операции возведения в степень. Поэтому измерив значение, становится возможным получить значение фазы.

Вычисление числа отмеченных элементов

Объединив алгоритм Гровера и КПФ, можно вычислить приближённое значение числа отмеченных элементов. Так как собственные значения оператора Гровера имеют вид е±2iθ, где sinθ = k /N , можно получить значения k - число отмеченных элементов - через алгоритм оценки фазы.

![](https://thumb.tildacdn.com/tild3638-3735-4461-a634-393231393433/-/resize/560x/-/format/webp/image011.png)

HHL алгоритм

Алгоритм оценки фазы также внедрён в алгоритм HHL для решения линейных систем уравнений. Ход алгоритма чуть сложнее описанных ранее и связан с вычислением и преобразованием собственных значений, но он занимает важное место, например, для квантового машинного обучения.

![](https://thumb.tildacdn.com/tild3231-3462-4635-b138-653532353662/-/resize/560x/-/format/webp/image017.png)

5.4. Моделирование в Quirk и запуск в IBM Quantum Experience

Моделирование в Quirk

(Анализ схем алгоритма, здесь a = B, m = R, x = А; операции возведения в степень, визуализация значений до измерения в виде пиков, КПФ, разделение на сегменты; изменение числа а и сегментов; в схеме, с увеличенными значениями a и m, получаем более сглаженные пики, что говорит о вероятности получения близкого к пику значения.)

![](https://thumb.tildacdn.com/tild6661-6231-4163-a632-353036653330/-/resize/660x/-/format/webp/image019.jpg)

![](https://thumb.tildacdn.com/tild6633-6639-4861-b665-376561613933/-/resize/660x/-/format/webp/image021.jpg)

Запуск в IBM Quantum Experience

(Используется модуль AQUA, задаётся число N и пробное значение a, вычисляются делители, затем a меняется, проверка делителей.)

5.5. Квантовый отжиг: формулируем и решаем задачи, изучаем способы квантовых вычислений

Часть 13. Квантовый отжиг

Современные квантовые компьютеры пока далеки от идеала: всё так же высока доля ошибок, шума, устройства не имеют желаемых размеров и количества кубитов. Однако существует целый ряд задач, которые успешно решаются именно на квантовых машинах уже сейчас.

Задача "Максимальный разрез графа"

Предположим наличие графа, в котором рёбра соединяют между собой вершины. Необходимо разделить вершины на две группы так, чтобы как можно больше граней соединяли точки из разных групп. Это далеко не интересная игра: доказано, что задача относится к классам NP-сложных и APX-сложных², однако используя квантовый компьютер, можно предположить решение данной задачи или даже найти его.

² Класс задач, эффективные алгоритмы которых находят решения хуже оптимального не более чем на фиксированный процент.

![](https://thumb.tildacdn.com/tild6633-3566-4331-b762-633137633634/-/resize/360x/-/format/webp/image023.png)

Формулируем решение

Вершины графа определяются как Z, где Z может принимать либо значение 1, либо -1, в зависимости от принадлежности к той или иной группе. Тогда ребро есть произведение этих вершин - ZiZj. Задача сводится к минимизации суммы всех граней, так как, можно заметить, что при равенстве точек, произведение ZiZj = 1, если же они относятся к разным группам, ZiZj = -1.

Задача на примере

Для графа, состоящего из трёх вершин, необходимо минимизировать функцию H = Z1Z2 + Z1Z3. Здесь группы разделяются на 0 и 1. После расчёта вероятностей выясняется, что решениями будут варианты вершин 011 и 100.

![](https://static.tildacdn.com/tild3035-6135-4333-a535-396432376537/-/empty/image025.png)

Введение квантового вычисления

Теперь используем Z не только для записи значения вершины, но и как вентиль Z. Вектор |0⟩ соответствует столбцу (1;0), |1⟩ - (0;1). Используя систему Дирака, значения вершин двух групп можно представить как ⟨0|Z|0⟩ = 1, ⟨1|Z|1⟩ = -1. Благодаря тензорному умножению, возможна запись и для нескольких вершин одновременно: ⟨101|Z1Z3|101⟩ = (⟨1|Z1|1⟩) (⟨1|Z3|1⟩) = (-1) (-1) = 1.

Возвращение к примеру

Таким же образом происходит вычисление функции, определяющей граф, например, H = Z1Z2 + Z1Z3. Проверим для групп 011. ⟨011|H|011⟩ = ⟨011|Z1Z2 + Z1Z3|011⟩ = (⟨011|Z1Z2|011⟩) + (⟨011|Z1Z3|011⟩) = (-1) + (-1) = -2. Задача минимизации функции преобразована в задачу получения минимально возможного состояния группы кубитов.

Гамильтониан

На данном этапе решение задачи сводится к поиску минимального квантового состояния |x⟩ в вычислении ⟨x|H|x⟩. Это частный случай одного из главных вопросов физики: нахождения основного состояния гамильтониана - эрмитовой матрицы³ H.

³ Квадратная матрица комплексных чисел, которая после транспонирования равна комплексно-сопряжённой

Модель Изинга

В этой модели гамильтониан⁴ отражает взаимодействие частиц и связи их спинов. Они могут быть направлены вверх или вниз, поэтому для обозначения используют 1 и -1. И снова необходимо отыскать минимальное значение функции. Задача является NP-сложной, так как является частным случаем задачи о максимальном разрезе.

⁴ Оператор полной энергии системы

![](https://thumb.tildacdn.com/tild3935-6564-4365-a465-666536613231/-/resize/360x/-/format/webp/image027.png)

![](https://thumb.tildacdn.com/tild3662-3035-4337-b135-373963646534/-/resize/304x/-/format/webp/image029.png)

QUBO: Квадратичная безусловная двоичная оптимизация

Существуют и другие формулировки задач комбинаторики, например, QUBO, где переменные представляются в двоичной системе и имеют значения не 1 или -1, а 0 или 1. Для перехода между этими областями разработаны функции преобразования состояний, поэтому модель Изинга может быть легко приведена к модели QUBO и наоборот.

![](https://thumb.tildacdn.com/tild6464-6538-4030-a133-386636306639/-/resize/560x/-/format/webp/image031.png)

Адиабатическое квантовое вычисление

Адиабатическая теорема говорит о том, что гамильтониан, который находится в основном состоянии, медленно изменяясь в течение времени, остается в основном состоянии. То есть, если в систему не вводится энергия, он не сможет перескочить в другое положение. Поэтому в систему вводится гамильтониан, зависящий от времени H(t). На практике используют квантовый отжиг, где системе позволяют достаточно медленно развиваться во времени T, а в качестве финального Hf используют гамильтониан из модели Изинга. Процесс может повторяться несколько раз для получения лучшего результата H(t).

![](https://thumb.tildacdn.com/tild6634-3863-4238-a463-623061636339/-/resize/420x/-/format/webp/image033.png)

Применение на практике

Квантовый отжиг является не просто теоретическим методом; его широко применяют для реальных исследований. Например, в одной из работ в области физики элементарных частиц. В ней рассматривается отделение сигнала, образованного появлением бозона Хиггса из двух глюонов, который затем распадается на два фотона, от излучения во время генерации пары фотонов. Исследователи приходят к минимизации функции, эквивалентной рассматриваемой в модели Изинга. Сравнение метода квантового отжига с другими методами сортировки показывает его эффективность для небольшой выборки элементов (до 1000).

![](https://thumb.tildacdn.com/tild6133-3330-4137-b636-386662353733/-/resize/560x/-/format/webp/image035.png)

![](https://thumb.tildacdn.com/tild3633-6638-4539-b932-376530346133/-/resize/560x/-/format/webp/image037.png)

5.6. Тестим квантовые отжигатели на платформе D-Wave Leap

Проверка квантовых отжигателей на платформе Leap

(Leap - платформа канадской компании D-Wave, проверка модели Изинга; знакомство с функционалом платформы; компьютеры с большим числом кубитов и ограниченным числом операций; загрузка кода для решения задачи максимального разреза на python, ввод коэффициентов, анализ решений; внедрение алгоритма имитации отжига и алгоритма отжига, анализ решений; изменение числа переменных, получение большего числа решений.)
