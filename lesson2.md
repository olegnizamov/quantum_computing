# Одно- и двукубитные системы


Рекап: Кубиты, вентили и сфера Блоха

Повторение по вентилям: основные понятия при моделировании квантовых схем: кубиты и вентили

Напомним, квантовые вентили преобразуют значения состояний кубитов, а также проводят над ними различные действия. Так, X-вентиль обращает состояние «нуля» в «единицу» и наоборот, Z-вентиль не изменяет ноль и может представить фазу -1 как 1. Важным является H-вентиль – вентиль Адамара, - который даёт возможность переходить к суперпозиции значений кубита; это позволяет генерировать случайные кубиты. Конечно, существуют и другие, например, вентиль Y, который вместе с X и Z составляет группу, которая носит название вентили Паули. S и T вентили так же, как и вентиль Z являются диагональными: одним из значений является единица, другое представлено фазой (разные значения для каждого из вентилей).

![](https://thumb.tildacdn.com/tild3437-3736-4361-a261-363861656138/-/resize/560x/-/format/webp/01_1.png)

Сфера Блоха

Представим кубит на поверхности трёхмерной сферы. Для этого необходимо два параметра. Как мы знаем, кубит можно представить парой комплексных чисел, получается, для задания сферы Блоха понадобится четыре разных величины? Не совсем. Одно из значений отметается ввиду свойства нормализации, α и β представляем в виде, соответственно, косинуса и синуса угла поворота; в итоге получаем компактную форму записи состояния кубита, где изменяются лишь углы θ и φ.

![](https://thumb.tildacdn.com/tild3337-6336-4465-b662-656534366332/-/resize/560x/-/format/webp/0026_1.png)

Представление кубита в виде сферы Блоха

Изобразим значение кубита в виде трёхмерной единичной сферы. Здесь, θ - широта кубита, т.е. величина, отражающая перемещение кубита относительно северного полюса, φ - долгота, что показывает перемещение относительно оси OX; северному полюсу соответствует значение 0, южному - 1.

![](https://thumb.tildacdn.com/tild6637-6461-4233-a639-313335653333/-/resize/260x/-/format/webp/0027_1.png)

2.1. Что такие вентили вращения и как их применять

Вентили вращения

Вентили вращения позволяют повернуть сферу на заданный угол относительно одной из осей. Они имеют форму экспоненциальной зависимости от произведения вентилей X, Y или Z, минус мнимой единицы и половины угла θ.

![](https://thumb.tildacdn.com/tild3737-3738-4533-b564-393838636463/-/resize/560x/-/format/webp/0028_1.png)

2.2. Применение вентилей вращения

Использование вентилей вращения для создания однокубитных вентилей

Исходя из описания вентилей вращения можно сказать, что для любого однокубитного вентиля существуют единичный вектор r и угол θ такие, что:

![](https://thumb.tildacdn.com/tild3961-3937-4030-a137-616165353463/-/resize/560x/-/format/webp/0029_1.png)

Скалярное произведение, система обозначений Дирака¹

Пользуясь системой Дирака, можно описать скалярное произведение двух состояний кубита. Состояние первого кубита представляется в виде “бра”, состояние второго будет “кет”². И далее, раскладывая скобки, остаётся лишь вычислить произведения базисных состояний. Описание данной системы может оказаться сложным для примера с небольшим числом коэффициентов, однако открывает широкие возможности для других вариантов значений.

¹ Система, предназначенная для описания квантовых состояний с использованием скобок.

² В системе обозначений Дирака векторы вида |a⟩ называются кет-векторами, а вида ⟨b| бра-векторами. Термины произошли от английского слова bracket (скобка).

![](https://thumb.tildacdn.com/tild3237-3763-4530-b132-366466373762/-/resize/560x/-/format/webp/0030_1.png)

Демонстрация работы вентилей в Quirk

(Влияние преобразований, фаз; расположение на сфере Блоха после введения вентилей; ввод вентилей вращения)

² Свойства и фундаментальные принципы квантовой механики.

![](https://thumb.tildacdn.com/tild3966-3138-4033-a531-326435646531/-/resize/760x/-/format/webp/quirk.jpg)

2.3. Практика применения вентилей в однокубитных системах для шифрования

Протокол BB-84

Это протокол для кодирования информации. Представьте себе двух людей - Алису и Боба, - которые хотят тайно начать вести переписку. Алиса посылает Бобу сообщение, например, это двоичный код, но есть проблема - они общаются по незащищённому каналу и кто-то может перехватить сообщение. Эта задача решилась в середине двадцатого века с появлением системы одноразовых ключей. Чтобы обеспечить безопасную переписку Алисы и Боба, вводится шифр, случайная последовательность 0 и 1, который известен только им двоим. Этот код имеет такую же длину, что и отправляемое сообщение, и является уникальным, поэтому никто не в силах узнать ничего из передаваемой ими информации. Конечно, никто, кроме Боба, который, используя ключ, может восстановить исходное послание от Алисы.

![](https://thumb.tildacdn.com/tild6461-3533-4366-a335-323166336637/-/resize/300x/-/format/webp/one-time-pad.png)

Возникающие трудности

Но что делать, если Алиса и Боб находятся на расстоянии и до этого не обменивались шифром, который никак нельзя исключить? Решение проблемы передачи ключа приводится в протоколах о защищенной связи, например, [протоколе Диффи-Хеллмана](https://ru.wikipedia.org/wiki/%D0%9F%D1%80%D0%BE%D1%82%D0%BE%D0%BA%D0%BE%D0%BB_%D0%94%D0%B8%D1%84%D1%84%D0%B8_%E2%80%94_%D0%A5%D0%B5%D0%BB%D0%BB%D0%BC%D0%B0%D0%BD%D0%B0). Он основан на предположении о вычислительной сложности: допущении наличия таких числовых задач, которые сложны для вычисления классическим компьютером, а квантовый компьютер может и вовсе уничтожить это сообщение.

⁴ Задачи, решение которых определяется за полиномиальное время.

Действия Алисы

В 1984 Чарльз Беннетт и Жиль Брассард предложили первый протокол о квантовом распределении ключей, что позволил Алисе полностью безопасно послать ключ Бобу, используя возможности квантовой физики. Для этого Алиса генерирует ключ - строку случайных битов. Далее по каждому биту она случайно выбирает один из базисов для шифрования - либо {|0⟩,|1⟩}, либо {|+⟩,|−⟩}. И мы предполагаем, что существует квантовый канал связи между Алисой и Бобом, который не обязательно должен быть защищенным, по которому она отправит получившиеся кубиты.

Действия Боба

Боб, каждый раз получая кубиты от Алисы, независимо решает использовать ему {|0⟩,|1⟩} или {|+⟩,|−⟩} базис для полученных значений. Для значений базиса {|+⟩,|−⟩} используется H-вентиль, что перемещает “+” в северную часть сферы, “−” в южную. В результате, Бобу необходимо записать результат: если использован {|0⟩,|1⟩} базис, он пишет 0 при получении |0⟩, 1 при получении |1⟩; если использован {|+⟩,|−⟩} базис, ему необходимо записать 0, когда получен |+⟩, 1, когда получен |−⟩.

На связи

Теперь у каждого из них есть по цепочке битов. Для получения ключа они связываются через классический канал связи, и Алиса говорит Бобу, какой вариант базиса она использовала для шифрования кубитов. Боб проверяет, использовал ли он тот же базис или нет. Если он сопоставил кубиты с действительно верным вариантом базиса, то сейчас у него окажется идентичный код, отправленному Алисой.

Картина идеального течения протокола

(Здесь кубиты вводятся как фотоны. Сравнивая выбранные Бобом и Алисой базисы, находим одинаковые значения. Это пример идеальных обстоятельств, когда отсутствуют помехи и перехваты.)

![](https://thumb.tildacdn.com/tild6236-3565-4430-b465-613232333734/-/resize/760x/-/format/webp/bb84.png)

2.4. Ошибки применения протоколов квантового распределения ключе

Проверка безопасности

Чтобы подтвердить невозможность вмешательства в этот вариант переписки, представим существование Евы, у которой появился доступ к каналу передачи кубитов от Алисы. Ева их дешифрует и пересылает Бобу. Здесь она сталкивается с первой проблемой: Ева не знает, какой базис выберет Алиса для кодирования. Поэтому при проверке Боб легко поймёт, что что-то идёт не так и кто-то перепутал кубиты. Рассмотрим другой вариант, когда Ева просто сохраняет себе полученные значения и также отсылает оригинал Бобу. Она дожидается оглашения Алисой базиса и получает секретные значения кубитов. Это могло бы сработать, если бы не существовала теорема о запрете клонирования³ и можно было идеально скопировать значения кубитов. По итогу, и эти, и другие варианты атак приходят к провалу.

³ Утверждение квантовой теории о невозможности создания идеальной копии произвольного неизвестного квантового состояния.

Синхронизация данных и усиление конфиденциальности

Ввиду изъянов на канале или неполадок устройства, а также прослушивания, некоторые из битов Алисы и Боба могут отличаться. Однако, зная это, может быть запущен процесс синхронизации информации. Во избежании утечки информации на этой стадии, усиливается её конфиденциальность, например, применяя экстракторы случайностей⁴.

⁴ Функция, генерирующая случайные выходные данные, которые являются независимыми от источника, а также равномерно распределены.

![](https://thumb.tildacdn.com/tild6462-3062-4736-b164-306236626138/-/resize/560x/-/format/webp/0040_1.png)

Распределение квантовых ключей в ЦЕРН

Ещё в 2009 году ЦЕРН [участвовал](https://arxiv.org/ftp/arxiv/papers/1203/1203.4940.pdf) в одной из первых международных сетей передачи квантовых ключей. Техническая часть той сети располагалась во Франции, некоторые узлы в Женеве. Этот проект длился около полутора лет; сейчас ЦЕРН продолжает работать в открытой сети передачи квантовых ключей (OQKD) для повышения качества работы данных протоколов.

Другие однокубитные протоколы

С помощью [трёхступенчатого протокола Кака](https://ru.wikipedia.org/wiki/%D0%9F%D1%80%D0%BE%D1%82%D0%BE%D0%BA%D0%BE%D0%BB_%D1%82%D1%80%D1%91%D1%85%D1%8D%D1%82%D0%B0%D0%BF%D0%BD%D0%BE%D0%B3%D0%BE_%D0%BA%D0%B2%D0%B0%D0%BD%D1%82%D0%BE%D0%B2%D0%BE%D0%B3%D0%BE_%D1%88%D0%B8%D1%84%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F) можно заняться настоящим шифрованием, квантово кодируя информацию. Квантовое одноразовое шифрование используется для варианта слепого квантового вычисления, когда зашифрованная информация передаётся незащищённому компьютеру, компьютер проводит над ней заданные пользователем действия и отсылает обратно для восстановления. Другие протоколы, использующие независимые кубиты: [B92](https://ru.wikipedia.org/wiki/B92), [SARG04](https://ru.wikipedia.org/wiki/SARG04), [идея квантовых денег](https://ru.wikipedia.org/wiki/%D0%9A%D0%B2%D0%B0%D0%BD%D1%82%D0%BE%D0%B2%D1%8B%D0%B5_%D0%B4%D0%B5%D0%BD%D1%8C%D0%B3%D0%B8), [бомбовое испытательное устройство Элицура-Вайдмана](http://lightcone.ru/elitzur-vaidman/).

![](https://thumb.tildacdn.com/tild6635-6165-4039-b262-653937363834/-/resize/560x/-/format/webp/quantum-money.png)

Работа с BB-84 в IBM Quantum Experience

(Генерация случайных битов, выбор базисов, измерение состояний, проверка совпадения значений цепочки)

![](https://thumb.tildacdn.com/tild6563-3061-4564-b336-343663313761/-/resize/760x/-/format/webp/image033.png)

2.5. Двухкубитные схемы и способы применения квантовых вентилей

Работа с двумя кубитами

Как мы знаем, кубит может иметь два варианта состояний: 0 или 1; соответственно, для двух кубитов это четыре возможных значения. Основное выражение, описывающее двухкубитные системы, представляет собой комбинацию четырёх вероятных значений и амплитуд, также являющихся комплексными числами. Эти амплитуды являются вероятностями становления того или иного значения.

Частичное определение в двухкубитной системе

Кубит принимает значения 0 или 1 с вероятностью, равной некоторому коэффициенту. В случае двухкубитной системы эта вероятность будет равна суперпозиции вероятностей равенства, например, первого кубита 0 или 1. Аналогично и для второго кубита. Поэтому, чтобы определить значение только одного из кубитов, понадобится вычислить отношение суммы величин, описывающих состояние кубита, к суперпозиции⁵ вероятностей равенства кубита тому или иному значению.

⁵ Результирующий эффект системы воздействий есть сумма эффектов, вызываемых каждым из воздействий системы в отдельности.

![](https://thumb.tildacdn.com/tild3965-3362-4734-b935-636433383434/-/resize/560x/-/format/webp/image037.png)

Векторное представление системы

Двухкубитную систему также можно представить в виде вектора-столбца из четырёх строк. Используя систему Дирака, можно вычислить внутренние произведения значений - при совпадении значений произведение будет равно единице, при их неравенстве - нулю. Стоит также отметить, учитывая величину вектора для описания двух кубитов, что двухкубитные вентили являются единичными матрицами, размера 4х4.

![](https://thumb.tildacdn.com/tild3538-3439-4266-b138-633965333961/-/resize/560x/-/format/webp/image039.png)

Получение квантовых вентилей

Простейшим способом получения двухкубитного вентиля будет введение пары однокубитных вентилей для каждого из кубитов в системе. В таком случае желаемый вентиль будет представлять собой матрицу, равную тензорному произведению матриц однокубитных вентилей. Данный вариант не подходит для создания всех возможных вариантов двухкубитных вентилей.

![](https://thumb.tildacdn.com/tild3730-3164-4536-b333-356438383533/-/resize/760x/-/format/webp/image041.png)

2.6. Вентиль контролируемого отрицания, его применение и запрет клонирования

Вентиль CNOT

Примером двухкубитного вентиля, который не может быть создан с помощью тензорного произведения матриц, служит вентиль контролируемого отрицания - CNOT. Он имеет вид квадратной матрицы, размера 4х4, с единицами на главной диагонали. Отрицание является контролируемым, так как применяется лишь ко второму кубиту при условии равенства первого единице. То есть, для примера, пара кубитов |01⟩ после подключения данного вентиля останется без изменений, тогда как |10⟩ станет равна |11⟩ (первый кубит - единица, значит второй приводится к противоположному значению: был ноль, стала единица).

![](https://thumb.tildacdn.com/tild3866-3935-4731-b463-353632626364/-/resize/510x/-/format/webp/image043.png)

Почему CNOT так важен?

Данный вентиль позволяет создавать квантовую запутанность. Также CNOT даёт возможность копировать классическую информацию (значения кубитов), несмотря на теорему о запрете клонирования⁶. Одна из наиболее важных функций данного вентиля заключается в том, что с его помощью осуществляется создание других контролируемых вентилей.

⁶ См. раздел 7.

![](https://thumb.tildacdn.com/tild3866-3935-4731-b463-353632626364/-/resize/460x/-/format/webp/image043.png)

![](https://thumb.tildacdn.com/tild3332-6130-4764-b434-376537393461/-/resize/560x/-/format/webp/image045.png)

Эквиваленты CNOT

CNOT бывает сложно рассчитать и создать не только на квантовых компьютерах, но и на суперкомпьютерах и других вариантах компьютеров разного уровня. Несмотря на это, понятно, что вентиль имеет очень важные рабочие функции. Поэтому проводятся равносильные замены стандартной схемы, например, введением вентилей Адамара до и после самого CNOT-вентиля на каждом из кубитов, чтобы заменить ключевую точку на цель и наоборот. Используя три CNOT-вентиля подряд, можно поменять местами значения кубитов. Также, как было упомянуто ранее, вентиль CNOT используют для создания других контролируемых вентилей, исходя из представления вентиля через сферу Блоха (поворот по какой-либо из осей).

![](https://thumb.tildacdn.com/tild3134-3562-4134-b063-353030316535/-/resize/560x/-/format/webp/image047.png)

![](https://thumb.tildacdn.com/tild6134-3230-4838-b431-356262646462/-/resize/560x/-/format/webp/image049.png)

2.7. Запрет клонирования и квантовая запутанность

Теорема о запрете клонирования

Допустим, существует такой вентиль U, что U| *Ψ* ⟩|0⟩=| *Ψ* ⟩| *Ψ* ⟩. Фактически, он копирует значение Ψ на оба кубита. Но описание этого действия с помощью свойства линейности (т.к. вентиль = линейное преобразование) не совпадает с другой его формой - в виде тензорного произведения. Это подтверждает несуществование функции или вентиля, создающих дубликаты значений кубита.

![](https://thumb.tildacdn.com/tild3736-6566-4663-b638-373631363261/-/resize/560x/-/format/webp/image051.png)

Квантовая запутанность

Кубиты могут быть представлены тензорным произведением нескольких меньших независимых кубитов. Однако существуют такие значения, которые невозможно получить таким путём. Они имеют название квантово запутанных, часто именуются и состояниями Белла. Такие состояния очень тесно связаны, а значение такой системы невозможно описать, объединив описания её частей.

![](https://thumb.tildacdn.com/tild6538-6664-4531-a363-386561346666/-/resize/560x/-/format/webp/image053.png)

2.8. Наблюдаем запутанность на реальной схеме

Hello, entangled world!

Опишем вторую простейшую схему квантового моделирования, что позволяет создать одно из состояний Белла. В систему вводятся вентиль Адамара и вентиль контролируемого отрицания. Измерив верхний кубит, узнаём, что вероятность его равенства 0 или 1 равна 50%; при измерении второго кубита выясняется, что вероятность 0 или 1 становится равной 100%.

![](https://thumb.tildacdn.com/tild3631-3636-4833-b734-636632386563/-/resize/560x/-/format/webp/image055.png)

Проверка свойства запутанности в IBM Quantum Experience

(Создание схемы, её запуск, рассмотрение вероятностей возникновения того или иного значения, запуск на квантовом компьютере IBM, выбор квантовых компьютеров)

![](https://thumb.tildacdn.com/tild6366-3134-4864-a233-386235306265/-/resize/760x/-/format/webp/image057.png)
